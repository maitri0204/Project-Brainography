{% extends "base.html" %}

{% block title %}Profile - {% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h3 class="card-title mb-0">
                        <i class="fas fa-user"></i> Profile
                    </h3>
                </div>
                
                <div class="card-body">
                    <form method="POST" enctype="multipart/form-data">
                        <div class="row">
                            <!-- Left Column - Read-only Fields -->
                            <div class="col-md-6">
                                <h5 class="mb-3 text-muted">Company Information</h5>
                                
                                <!-- Franchise Name (Read-only) -->
                                <div class="form-group mb-3">
                                    <label class="form-label">Franchise Name</label>
                                    <input type="text" class="form-control" value="{{ franchise.franchise_name }}" readonly style="background-color: #f8f9fa;">
                                </div>
                                
                                <!-- Company Name (Read-only) -->
                                <div class="form-group mb-3">
                                    <label class="form-label">Company Name</label>
                                    <input type="text" class="form-control" value="{{ franchise.company_name }}" readonly style="background-color: #f8f9fa;">
                                </div>
                                
                                <!-- Email (Read-only) -->
                                <div class="form-group mb-3">
                                    <label class="form-label">Email</label>
                                    <input type="email" class="form-control" value="{{ franchise.email }}" readonly style="background-color: #f8f9fa;">
                                </div>
                                
                                <!-- Website (Read-only) -->
                                <div class="form-group mb-3">
                                    <label class="form-label">Website</label>
                                    <input type="text" class="form-control" value="{{ franchise.website }}" readonly style="background-color: #f8f9fa;">
                                </div>
                                
                                <!-- GST Number (Read-only) -->
                                <div class="form-group mb-3">
                                    <label class="form-label">GST Number</label>
                                    <input type="text" class="form-control" value="{{ franchise.gst_number }}" readonly style="background-color: #f8f9fa;">
                                </div>
                                
                                <!-- PAN Number (Read-only) -->
                                <div class="form-group mb-3">
                                    <label class="form-label">PAN Number</label>
                                    <input type="text" class="form-control" value="{{ franchise.pan_number }}" readonly style="background-color: #f8f9fa;">
                                </div>
                            </div>
                            
                            <!-- Right Column - Editable Fields -->
                            <div class="col-md-6">
                                <h5 class="mb-3 text-primary">Editable Information</h5>
                                
                                <!-- Address (Editable) -->
                                <div class="form-group mb-3">
                                    <label class="form-label">Address <span class="text-danger">*</span></label>
                                    <textarea name="address" class="form-control" rows="3" placeholder="Use commas to separate lines (e.g., 101 ABC Center, DEF Road, GHI area, City-Pincode)">{{ franchise.address }}</textarea>
                                    <small class="form-text text-muted">Tip: Use commas to create line breaks in your address</small>
                                </div>
                                
                                <!-- Phone (Editable) -->
                                <div class="form-group mb-3">
                                    <label class="form-label">Phone Number <span class="text-danger">*</span></label>
                                    <input type="text" name="phone" class="form-control" value="{{ franchise.phone }}" placeholder="Enter phone number">
                                </div>
                                
                                <!-- WhatsApp Number (Editable) -->
                                <div class="form-group mb-3">
                                    <label class="form-label">WhatsApp Number</label>
                                    <input type="text" name="whatsapp_number" id="whatsapp_number" class="form-control" value="{{ franchise.whatsapp_number }}" placeholder="Enter WhatsApp number">
                                    <div class="form-check mt-2">
                                        <input class="form-check-input" type="checkbox" id="same_as_phone">
                                        <label class="form-check-label" for="same_as_phone">
                                            Same as above (Phone Number)
                                        </label>
                                    </div>
                                </div>
                                
                                <!-- Logo (Editable) -->
                                <div class="form-group mb-3">
                                    <label class="form-label">Company Logo</label>
                                    {% if franchise.logo_filename %}
                                    <div class="mb-2">
                                        <img src="{{ url_for('static', filename=franchise.logo_filename) }}" 
                                             alt="Current Logo" class="img-thumbnail" style="max-height: 100px;">
                                        <small class="form-text text-muted d-block">Current logo</small>
                                    </div>
                                    {% endif %}
                                    <input type="file" name="logo" class="form-control" accept="image/*">
                                    <small class="form-text text-muted">Upload new logo (Max 2MB, JPG/PNG/GIF)</small>
                                </div>
                                
                                <!-- Submit Button -->
                                <div class="form-group mt-4">
                                    <button type="submit" class="btn btn-primary btn-lg w-100">
                                        <i class="fas fa-save"></i> Update Profile
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* Additional styles to maintain consistency */
.card-header {
    background-color: #f8f9fa;
    border-bottom: 1px solid #dee2e6;
}

.form-label {
    font-weight: 600;
    margin-bottom: 0.5rem;
}

.text-danger {
    color: #dc3545 !important;
}

.text-primary {
    color: #007bff !important;
}

.text-muted {
    color: #6c757d !important;
}

.img-thumbnail {
    border: 1px solid #dee2e6;
    border-radius: 0.25rem;
    padding: 0.25rem;
}

.btn-lg {
    padding: 0.5rem 1rem;
    font-size: 1.25rem;
    border-radius: 0.3rem;
}
</style>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const phoneInput = document.querySelector('input[name="phone"]');
    const whatsappInput = document.getElementById('whatsapp_number');
    const sameAsPhoneCheckbox = document.getElementById('same_as_phone');
    
    // Function to copy phone number to WhatsApp field
    function copyPhoneToWhatsApp() {
        if (sameAsPhoneCheckbox.checked) {
            whatsappInput.value = phoneInput.value;
            whatsappInput.readOnly = true;
            whatsappInput.style.backgroundColor = '#f8f9fa';
        } else {
            whatsappInput.readOnly = false;
            whatsappInput.style.backgroundColor = '';
        }
    }
    
    // Event listener for checkbox change
    sameAsPhoneCheckbox.addEventListener('change', copyPhoneToWhatsApp);
    
    // Event listener for phone number changes (when checkbox is checked)
    phoneInput.addEventListener('input', function() {
        if (sameAsPhoneCheckbox.checked) {
            whatsappInput.value = phoneInput.value;
        }
    });
    
    // Check if phone and whatsapp numbers are the same on page load
    if (phoneInput.value && whatsappInput.value && phoneInput.value === whatsappInput.value) {
        sameAsPhoneCheckbox.checked = true;
        copyPhoneToWhatsApp();
    }
});
</script>
{% endblock %}
